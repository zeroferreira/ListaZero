rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Solicitudes de canciones
    match /solicitudes/{doc} {
      allow read: if true;
      allow create: if true;
      allow delete: if true;
      allow update: if false; // Las solicitudes no se modifican, solo se crean y eliminan
    }

    // Usuarios VIP (para el filtro y panel admin)
    match /vipUsers/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Usuarios Z0-VIP (para el filtro y panel admin)
    match /z0VipUsers/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Usuarios Donadores temporales (para el filtro y panel admin)
    match /donadorUsers/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Usuarios registrados (para poblar select en Admin)
    match /users/{doc} {
      allow read: if true;
      allow create, update: if true;
      allow delete: if true;
    }

    // Estadísticas de usuarios (para gamificación y stats)
    match /userStats/{userId} {
      allow read, write: if true;
    }

    // Logros de usuarios (para sistema de gamificación)
    match /userAchievements/{userId} {
      allow read, write: if true;
    }

    // Configuraciones de usuario (temas, preferencias)
    match /userSettings/{userId} {
      allow read, write: if true;
    }

    // Recompensas disponibles (catálogo de recompensas)
    match /rewards/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Solicitudes de recompensas de usuarios
    match /rewardRequests/{doc} {
      allow read, write: if true;
    }

    // Historial de recompensas canjeadas
    match /redeemedRewards/{doc} {
      allow read, write: if true;
    }

    // Configuración global del sistema
    match /systemConfig/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Logs de actividad del sistema (opcional, para debugging)
    match /activityLogs/{doc} {
      allow read: if true;
      allow create: if true;
      allow update, delete: if true;
    }

    // Datos de sesión temporal (para sincronización en tiempo real)
    match /sessionData/{userId} {
      allow read, write: if true;
    }

    // Datos de canciones reproducidas por día (solo el DJ/admin puede modificar)
    match /playedSongs/{day} {
      allow read: if true;
      allow create: if true;
      allow update: if true;
      allow delete: if true;
    }

    // Métricas y analytics del sistema
    match /analytics/{doc} {
      allow read: if true;
      allow create: if true;
      allow update, delete: if true;
    }

    // Notificaciones globales del sistema (opcional para futuras funcionalidades)
    match /globalNotifications/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Eventos del sistema en tiempo real (para sincronización avanzada)
    match /systemEvents/{doc} {
      allow read: if true;
      allow create: if true;
      allow update, delete: if true;
    }

    // Backup de datos del sistema
    match /backups/{doc} {
      allow read: if true;
      allow create, update, delete: if true;
    }

    // Historial de canciones reproducidas (para análisis y estadísticas)
    match /playedSongsHistory/{doc} {
      allow read: if true;
      allow create: if true;
      allow update, delete: if true;
    }
  }
}